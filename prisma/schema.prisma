generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model User {
    id           Int     @id @default(autoincrement())
    oidcId       String  @unique
    studentId    String  @unique
    firstNameTh  String
    middleNameTh String?
    lastNameTh   String
    firstNameEn  String
    middleNameEn String?
    lastNameEn   String

    userShortenedLinks UserShortenedLink[] @relation("UserToShortenedLink")
    userQrCodes        UserQrCode[]        @relation("UserToQrCodeGen")
}

model UserShortenedLink {
    id     Int    @id @default(autoincrement())
    name   String
    url    String
    slug   String @unique
    userId Int
    count  Int    @default(0)

    user                            User                             @relation(fields: [userId], references: [id], name: "UserToShortenedLink")
    userShortenedLinkVisitedRecords UserShortenedLinkVisitedRecord[] @relation("UserShortenedLinkVisitedRecords")

    editedAt DateTime @default(now())
}

model UserShortenedLinkVisitedRecord {
    id Int @id @default(autoincrement())

    utmCampaignSource   String?
    utmCampaignMedium   String?
    utmCampaignName     String?
    utmCampaignId       String?
    utmCampaignTerm     String?
    utmCampaignContent  String?
    userShortenedLinkId Int

    userShortenedLink UserShortenedLink @relation(fields: [userShortenedLinkId], references: [id], name: "UserShortenedLinkVisitedRecords")

    editedAt DateTime @default(now())
}

model UserQrCode {
    id     Int     @id @default(autoincrement())
    name   String
    url    String
    qrCode String
    color  String
    logo   String?
    userId Int

    user User @relation(fields: [userId], references: [id], name: "UserToQrCodeGen")

    editedAt DateTime @default(now())
}
